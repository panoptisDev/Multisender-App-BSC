{
  "version": 3,
  "names": [
    "React",
    "useRef",
    "useEffect",
    "useImperativeHandle",
    "useState",
    "useMemo",
    "CodeMirror",
    "jsx",
    "_jsx",
    "defaultOptions",
    "tabSize",
    "autoCloseBrackets",
    "matchBrackets",
    "showCursorWhenSelecting",
    "lineNumbers",
    "fullScreen",
    "ReactCodeMirror",
    "props",
    "ref",
    "options",
    "value",
    "width",
    "height",
    "lazyLoadMode",
    "editor",
    "setEditor",
    "textareaRef",
    "lastestProps",
    "textarea",
    "current",
    "getEventHandleFromProps",
    "propNames",
    "Object",
    "keys",
    "eventHandle",
    "filter",
    "keyName",
    "test",
    "eventDict",
    "forEach",
    "ele",
    "name",
    "slice",
    "replace",
    "toLowerCase",
    "setOptions",
    "_x",
    "_x2",
    "_setOptions",
    "apply",
    "arguments",
    "_asyncToGenerator",
    "instance",
    "opt",
    "window",
    "mode",
    "findModeByName",
    "mime",
    "JSON",
    "stringify",
    "setOption",
    "fromTextArea",
    "_extends",
    "event",
    "on",
    "setValue",
    "setSize",
    "toTextArea",
    "undefined",
    "val",
    "getValue",
    "children",
    "forwardRef"
  ],
  "sources": [
    "../src/index.js"
  ],
  "sourcesContent": [
    "import React, { useRef, useEffect, useImperativeHandle, useState, useMemo } from 'react';\nimport CodeMirror from 'codemirror';\nimport 'codemirror/mode/meta';\nimport './codemirror.css';\n\nconst defaultOptions = {\n  tabSize: 2,\n  autoCloseBrackets: true,\n  matchBrackets: true,\n  showCursorWhenSelecting: true,\n  // 显示行号\n  lineNumbers: true,\n  fullScreen: true,\n}\n\nfunction ReactCodeMirror(props = {}, ref) {\n  const { options = {}, value = '', width = '100%', height = '100%', lazyLoadMode = true } = props;\n  const [editor, setEditor] = useState();\n  const textareaRef = useRef();\n  const lastestProps = useRef(props);\n\n  useImperativeHandle(ref, () => ({ editor, textarea: textareaRef.current }), [editor, textareaRef]);\n  lastestProps.current = props;\n  \n  // 将props中所有的事件处理函数映射并保存\n  function getEventHandleFromProps() {\n    const propNames = Object.keys(props);\n    const eventHandle = propNames.filter((keyName) => {\n      return /^on+/.test(keyName);\n    });\n\n    const eventDict = {};\n    eventHandle.forEach((ele) => {\n      const name = ele.slice(2);\n      if (name && name[0]) {\n        eventDict[ele] = name.replace(name[0], name[0].toLowerCase());\n      }\n    });\n\n    return eventDict;\n  }\n\n  // http://codemirror.net/doc/manual.html#config\n  async function setOptions(instance, opt = {}) {\n    if (typeof opt === 'object' && window) {\n      const mode = CodeMirror.findModeByName(opt.mode || '');\n      if (lazyLoadMode && mode && mode.mode) {\n        await import(`codemirror/mode/${mode.mode}/${mode.mode}.js`);\n      }\n      if (mode) {\n        opt.mode = mode.mime;\n      }\n      Object.keys(opt).forEach((name) => {\n        if ((opt[name] || opt[name] === false) && JSON.stringify(opt[name])) {\n          instance.setOption(name, opt[name]);\n        }\n      });\n    }\n  }\n\n  useEffect(() => {\n    if (!editor && window) {\n      // 生成codemirror实例\n      const instance = CodeMirror.fromTextArea(textareaRef.current, {...defaultOptions, ...options});\n      const eventDict = getEventHandleFromProps();\n      Object.keys(eventDict).forEach((event) => {\n        instance.on(eventDict[event], (...params) => lastestProps.current[event](...params));\n      });\n      instance.setValue(value || '');\n\n      if (width || height) {\n        // 设置尺寸\n        instance.setSize(width, height);\n      }\n      setEditor(instance);\n      setOptions(instance, {...defaultOptions, ...options});\n    }\n    return () => {\n      if (editor && window) {\n        editor.toTextArea();\n        setEditor(undefined);\n      }\n    }\n  }, []);\n\n  useMemo(() => {\n    if (!editor || !window) return;\n    const val = editor.getValue();\n    if (value !== undefined && value !== val) {\n      editor.setValue(value);\n    }\n  }, [value]);\n\n  useMemo(() => {\n    if (!editor || !window) return;\n    editor.setSize(width, height);\n  }, [width, height]);\n\n\n  useMemo(() => {\n    if (!editor || !window) return;\n    setOptions(editor, {...defaultOptions, ...options});\n  }, [editor, options]);\n  \n  return (\n    <textarea ref={textareaRef}>{value}</textarea>\n  );\n}\n\nexport default React.forwardRef(ReactCodeMirror);\n"
  ],
  "mappings": "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"
}